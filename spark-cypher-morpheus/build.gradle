import com.github.jengelman.gradle.plugins.shadow.tasks.ShadowJar

description = 'Spark Cypher Morpheus'

dependencies {
    compile project(':morpheus-spark-cypher')

    // Morpheus Setting
    compile(group: 'org.apache.spark', name: "spark-cypher".scala(), version: "3.0.0-SNAPSHOT") {
        exclude group: 'org.apache.spark', module: 'spark-core'.scala()
        exclude group: 'org.apache.spark', module: 'spark-sql'.scala()
        exclude group: 'org.apache.spark', module: 'spark-catalyst'.scala()
    }

    compile group: 'org.apache.spark', name: "spark-core".scala(), version: ver.spark
    compile group: 'org.apache.spark', name: "spark-sql".scala(), version: ver.spark
    compile group: 'org.apache.spark', name: "spark-catalyst".scala(), version: ver.spark

    // Spark Cypher (SPIP setting)
//    compile(group: 'org.apache.spark', name: "spark-cypher".scala(), version: "3.0.0-SNAPSHOT")
}

task allJar(type: ShadowJar) {
    classifier = 'all'

    from project.sourceSets.main.output
    configurations = [project.configurations.runtime]

    dependencies {
        exclude(dependency('org.scala-lang:'))
        exclude(dependency('org.scala-lang.modules:'))
    }
    exclude "META-INF/versions/**/*"
}

pub.full.artifacts += 'allJar'
